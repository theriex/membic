application: myopenreviews
version: 1
runtime: python27
api_version: 1
threadsafe: true

libraries:
- name: pycrypto
  version: "2.3"

handlers:
######################################################################
##                  API
## authparams:
##   am: authentication method: "mid", "gid", "fbid", "twid"
##   at: authentication token from native or external source
##   an: authentication name (username if native auth, whatever otherwise)
##
######################################################################

######################################################################
##        MyOpenReviews local site authentication 

## Get an access token from native MyOpenReviews credentials
## params: user, pass 
- url: /login.*
  script: src.py.moracct.app

## Create a new native account on MyOpenReviews
## params: user, pass, email
- url: /newacct.*
  script: src.py.moracct.app

## Email forgotten native account credentials
## params: email
- url: /mailcred.*
  script: src.py.moracct.app

## Change native account password
## params: password, authparams
- url: /chgpwd.*
  script: src.py.moracct.app

######################################################################
##        Pen Names

## Fetch pen names for current authentication
## params: authparams
- url: /mypens.*
  script: src.py.pen.app

## Create new pen name for current authentication
## params: pen, authparams
- url: /newpen.*
  script: src.py.pen.app

## Update a pen name if authorized
## params: pen, authparams
- url: /updpen.*
  script: src.py.pen.app


######################################################################
# Static files and other stuff not really part of the API
#
- url: /cluck2.*
  script: src.py.cluck2.app
- url: /cluck.*
  script: src.py.cluck.app
# Trap anything ending with a slash and send it to index.html since there
# is no default processing to figure that out otherwise.
- url: (.*)/
  static_files: docroot/index.html
  upload: docroot
# Catchall is to look in docroot.
- url: /
  static_dir: docroot
